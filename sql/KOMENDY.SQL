-- CAŁKOWITA LICZBA ZAKAŻEŃ COVID-19 GLOBALNIE (Z PODZIAŁEM NA PAŃSTWA)
SELECT 
    KRAJ, 
    KOD, 
    SUM(PRZYPADKI_TYG) AS 'LICZBA PRZYPADKOW',
    CONCAT(ROUND(SUM(PRZYPADKI_TYG) / (SELECT SUM(PRZYPADKI_TYG) FROM covid_tygodniowe WHERE DAYOFWEEK(DZIEN) = 2 AND KOD <> '' AND KOD != 'OWI') * 100, 3), '%') AS 'UDZIAL (%)'
FROM covid_tygodniowe 
WHERE KOD NOT LIKE '' AND DAYOFWEEK(DZIEN) = 2 GROUP BY KRAJ, KOD 
ORDER BY SUM(PRZYPADKI_TYG) DESC;

-- RANKING CAŁKOWITEJ LICZBY ZAKAZEŃ COVID-19 GLOBALNIE (Z PODZIAŁEN NA PAŃSTWA)
SELECT
  RANK() OVER (ORDER BY liczba_przypadkow DESC) AS Ranking,
  KRAJ,
  KOD,
  liczba_przypadkow AS `Liczba przypadkow`
FROM (
  SELECT 
    KRAJ,
    KOD,
    SUM(PRZYPADKI_TYG) AS liczba_przypadkow
  FROM covid_tygodniowe
  WHERE KOD <> '' 
    AND KOD <> 'OWI' 
    AND DAYOFWEEK(DZIEN) = 2
  GROUP BY KRAJ, KOD
) t
ORDER BY liczba_przypadkow DESC;

-- TREND TYGODNIOWY ZAKAŻEŃ COVID-19
SELECT 
    YEARWEEK(DZIEN, 3) AS 'Rok_Tydzien', 
    YEAR(DZIEN) AS 'Rok', 
    WEEK(dzien, 3) AS 'Tydzien', 
    SUM(PRZYPADKI_TYG) AS 'Liczba zakazen COVID-19' 
FROM covid_tygodniowe 
WHERE KOD NOT LIKE '' AND KOD != 'OWI' AND DAYOFWEEK(DZIEN) = 2 
GROUP BY YEARWEEK(DZIEN, 3), YEAR(DZIEN), WEEK(DZIEN, 3) 
ORDER BY YEARWEEK(DZIEN, 3);

-- TREND MIESIĘCZNY ZAKAŻEŃ COVID-19 (ŁĄCZNIE DLA WSZYSTKICH LAT)
SELECT 
    MONTH(DZIEN) AS 'Rok', 
    SUM(PRZYPADKI_TYG) AS 'Liczba zakazen COVID-19' 
FROM covid_tygodniowe 
WHERE KOD NOT LIKE '' AND KOD != 'OWI' AND DAYOFWEEK(DZIEN) = 2 
GROUP BY MONTH(DZIEN) 
ORDER BY MONTH(DZIEN) ASC;

-- TREND MIESIĘCZNY ZAKAŻEŃ COVID-19 (ODDZIELNIE DLA WSZYSTKICH LAT)
SELECT 
    YEAR(DZIEN) AS 'Rok', 
    CONCAT(MONTH(DZIEN),' ',DATE_FORMAT(DZIEN, '%M')) AS 'Miesiac', 
    SUM(PRZYPADKI_TYG) AS 'Liczba zakazen COVID-19' 
FROM covid_tygodniowe 
WHERE KOD NOT LIKE '' AND KOD != 'OWI' AND DAYOFWEEK(DZIEN) = 2 
GROUP BY YEAR(DZIEN), MONTH(DZIEN) 
ORDER BY YEAR(DZIEN) ASC, MONTH(DZIEN) ASC;

-- TREND ROCZNY ZAKAŻEŃ COVID-19
SELECT 
    YEAR(DZIEN) AS 'Rok', 
    SUM(PRZYPADKI_TYG) AS 'Liczba zakazen COVID-19' 
FROM covid_tygodniowe 
WHERE KOD NOT LIKE '' AND KOD != 'OWI' AND DAYOFWEEK(DZIEN) = 2 
GROUP BY YEAR(DZIEN) 
ORDER BY YEAR(DZIEN) ASC;

-- CAŁKOWITA LICZBA ZAKAZEŃ COVID-19 (KONTYNENTY, STATUS EKONOMICZNY, ŚWIATOWY)
SELECT 
    KRAJ, 
    SUM(PRZYPADKI_TYG) AS 'Liczba zakazen COVID-19' 
FROM covid_tygodniowe 
WHERE DAYOFWEEK(DZIEN) = 2 AND KOD = '' 
GROUP BY KRAJ;

-- CAŁKOWITA LICZBA ZAKAZEŃ COVID-19 Z PODZIAŁEM NA KONTYNENTY
SELECT 
    KRAJ,
    SUM(PRZYPADKI_TYG) AS Liczba_zakazen
FROM covid_tygodniowe
WHERE DAYOFWEEK(DZIEN) = 2 AND KRAJ IN ('Africa','Asia','Europe','North America','South America','Oceania')
GROUP BY KRAJ
ORDER BY Liczba_zakazen DESC;

-- CAŁKOWITA LICZBA ZAKAŻEŃ COVID-19 Z PODZIAŁEM NA STATUS EKONOMICZNY
SELECT 
    KRAJ, 
    SUM(PRZYPADKI_TYG) AS 'Liczba zakazen COVID-19' 
FROM covid_tygodniowe 
WHERE DAYOFWEEK(DZIEN) = 2 AND KOD = '' AND KRAJ LIKE '%income%'
GROUP BY KRAJ
ORDER BY SUM(PRZYPADKI_TYG) DESC;

-- CAŁKOWITA LICZBA ZAKAŻEŃ COVID-19 GLOBALNIE
SELECT 
    KRAJ, 
    SUM(PRZYPADKI_TYG) AS 'Liczba zakazen COVID-19' 
FROM covid_tygodniowe 
WHERE DAYOFWEEK(DZIEN) = 2 AND KOD = '' AND KRAJ LIKE '%world%'
GROUP BY KRAJ
ORDER BY SUM(PRZYPADKI_TYG) DESC;


-- PEAK ZAKAŻEŃ COVID-19 (TYDZIEŃ)
SELECT 
    YEARWEEK(DZIEN, 3) AS 'Rok_Tydzien', 
    YEAR(DZIEN) AS 'Rok', 
    WEEK(dzien, 3) AS 'Tydzien', 
    SUM(PRZYPADKI_TYG) AS 'Liczba zakazen COVID-19' 
FROM covid_tygodniowe 
WHERE KOD NOT LIKE '' AND KOD != 'OWI' AND DAYOFWEEK(DZIEN) = 2 
GROUP BY YEARWEEK(DZIEN, 3), YEAR(DZIEN), WEEK(DZIEN, 3) 
ORDER BY SUM(PRZYPADKI_TYG) DESC, YEARWEEK(DZIEN, 3);

-- ŚREDNIA TYGODNIOWA ZAKAŻEŃ COVID-19 NA KRAJ
SELECT 
    YEARWEEK(DZIEN, 3) AS 'Rok_Tydzien', 
    YEAR(DZIEN) AS 'Rok', 
    WEEK(dzien, 3) AS 'Tydzien', 
    AVG(PRZYPADKI_TYG) AS 'Liczba zakazen COVID-19 (AVG)' 
FROM covid_tygodniowe 
WHERE KOD NOT LIKE '' AND KOD != 'OWI' AND DAYOFWEEK(DZIEN) = 2 
GROUP BY YEARWEEK(DZIEN, 3), YEAR(DZIEN), WEEK(DZIEN, 3) 
ORDER BY YEARWEEK(DZIEN, 3)

-- LICZBA ZAKAŻEŃ A UDZIAŁ KONTYNENTÓW (%): 
SELECT 
    KRAJ, 
    SUM(PRZYPADKI_TYG) AS Liczba_zakazen, 
    CONCAT(ROUND(SUM(PRZYPADKI_TYG) / (SELECT SUM(PRZYPADKI_TYG) FROM covid_tygodniowe WHERE DAYOFWEEK(DZIEN) = 2 AND KRAJ IN ('Africa','Asia','Europe','North America','South America','Oceania')) * 100, 2), ' %') AS 'Udzial (%)' 
FROM covid_tygodniowe 
WHERE DAYOFWEEK(DZIEN) = 2 AND KRAJ IN ('Africa','Asia','Europe','North America','South America','Oceania') 
GROUP BY KRAJ ORDER BY Liczba_zakazen DESC; 

-- HEATMAP (ROK NA MIESIACE): 
SELECT 
    YEAR(DZIEN) AS Rok, 
    SUM(CASE WHEN MONTH(DZIEN)=1 THEN PRZYPADKI_TYG END) AS Styczen, 
    SUM(CASE WHEN MONTH(DZIEN)=2 THEN PRZYPADKI_TYG END) AS Luty, 
    SUM(CASE WHEN MONTH(DZIEN)=3 THEN PRZYPADKI_TYG END) AS Marzec, 
    SUM(CASE WHEN MONTH(DZIEN)=4 THEN PRZYPADKI_TYG END) AS Kwiecien, 
    SUM(CASE WHEN MONTH(DZIEN)=5 THEN PRZYPADKI_TYG END) AS Maj, 
    SUM(CASE WHEN MONTH(DZIEN)=6 THEN PRZYPADKI_TYG END) AS Czerwiec, 
    SUM(CASE WHEN MONTH(DZIEN)=7 THEN PRZYPADKI_TYG END) AS Lipiec, 
    SUM(CASE WHEN MONTH(DZIEN)=8 THEN PRZYPADKI_TYG END) AS Sierpien, 
    SUM(CASE WHEN MONTH(DZIEN)=9 THEN PRZYPADKI_TYG END) AS Wrzesien, 
    SUM(CASE WHEN MONTH(DZIEN)=10 THEN PRZYPADKI_TYG END) AS Pazdziernik, 
    SUM(CASE WHEN MONTH(DZIEN)=11 THEN PRZYPADKI_TYG END) AS Listopad, 
    SUM(CASE WHEN MONTH(DZIEN)=12 THEN PRZYPADKI_TYG END) AS Grudzien 
FROM covid_tygodniowe 
WHERE KOD <> '' AND KOD <> 'OWI' AND DAYOFWEEK(DZIEN)=2 
GROUP BY YEAR(DZIEN) 
ORDER BY Rok;
